=== SECTION: COGNITIVE_SCRATCHPAD ===

[[LLM_INSTRUCTION]]: This template is instantiated at the start of every user prompt processing cycle. It is a volatile workspace for intermediate calculations, holding variables, and state tracking that do not need to be permanently stored in the character's modules. It MUST be completely cleared or wiped after the UPDATE_VERIFICATION step is complete.

Lifecycle:
- INSTANTIATE: Immediately upon parsing user input
- POPULATE: Used by all COTs during execution
- READ: Primarily used by DECISION_SYNTHESIS for final arbitration
- COMMIT: STATE_GOVERNANCE_AND_COMMIT reconciles and commits proposals
- WIPE: Deleted after final system update and verification

=== SECTION_BREAK ===

=== SECTION: CYCLE_METADATA ===

[[LLM_INSTRUCTION]]: These fields provide deterministic identity for the current processing cycle.

CYCLE_TAG: [e.g., 20251227_001, SCENE_12, SESSION_A_05]
USER_INPUT_RAW: "[The full text of the user's prompt]"
INFERRED_TIME_PASSAGE: [e.g., MOMENTS_LATER, NEXT_MORNING, DAYS_LATER, UNKNOWN]
DETECTED_TRIGGERS:
- [List of keywords or patterns that fired COTs]
IDENTIFIED_ENTITIES:
- [List of ENT_XX mentioned or implied]

=== SECTION_BREAK ===

=== SECTION: ACTIVE_IMPULSE_REGISTRY ===

[[LLM_INSTRUCTION]]: All COTs write generated behavioral impulses here. DECISION_SYNTHESIS reads this registry to make the final choice.

[[LLM_INSTRUCTION]]: Impulse entries are append-only within the cycle. Do not delete other COT entries.

IMPULSE_ENTRY:
IMPULSE_ID: [Optional stable ID if desired, else leave blank]
IMPULSE_SOURCE: [COT_NAME]
IMPULSE_TYPE: [e.g., FIGHT, FLIGHT, FREEZE, SEEK_PROXIMITY]
IMPULSE_STRENGTH: [0-100]
TARGET_ID: [Optional, e.g., ENT_01, SKL_03]
JUSTIFICATION: [Brief reason for generation]
JUSTIFICATION_CATEGORY: [DIRECT_APPLICATION | GUIDED_SYNTHESIS | UNJUSTIFIED_LEAP]

[[LLM_INSTRUCTION]]: Pre-arbitration impulse hygiene requirements.
IMPULSE_HYGIENE:
IMPULSE_NORMALIZED: [TRUE | FALSE]
IMPULSE_CAP_APPLIED: [TRUE | FALSE]
IMPULSE_CAP_N: [e.g., 8]
DEFERRED_IMPULSES_EXIST: [TRUE | FALSE]

=== SECTION_BREAK ===

=== SECTION: PROPOSED_UPDATES_REGISTRY ===

[[LLM_INSTRUCTION]]: All COTs must write intended persistent-state changes here. No COT may directly update persistent modules. Only STATE_GOVERNANCE_AND_COMMIT may commit these proposals.

[[LLM_INSTRUCTION]]: Bracket-path addressing is the API. All TARGET_FIELD values MUST be canonical bracket paths using machine-stable tokens per S_CANONICAL_TOKEN_DICTIONARY.

PROPOSAL_ENTRY:
PROPOSAL_ID: [Required, unique within cycle, e.g., PUP_20251227_01]
SOURCE_COT: [Required, e.g., STRESS_CASCADE_RESOLUTION]
TARGET_MODULE: [Required, e.g., BODY, RELATIONAL, TEMPORARY_MODIFIERS]
TARGET_FIELD: [Required, canonical bracket path, e.g., [BODY][BIOCHEMICAL_STATE_MARKERS][CORTISOL]]
OPERATION_TYPE: [Required, SET | TRANSITION | ADD_MODIFIER | REMOVE_MODIFIER | CAP | VETO]
PROPOSED_VALUE: [Required, value or structured payload]
STRENGTH: [Required, 0-100]
MECHANISM_TAG: [Required, e.g., HPA_AXIS, SYMPATHETIC, ENVIRONMENTAL_STRESS]
JUSTIFICATION: [Required, 1-2 lines]
NOTES: [Optional short notes]

=== SECTION_BREAK ===

=== SECTION: STATE_COMMIT_AUDIT ===

[[LLM_INSTRUCTION]]: Written only by STATE_GOVERNANCE_AND_COMMIT after reconciliation. Every proposal must be listed exactly once as COMMITTED, SUPPRESSED, or DOWNGRADED.

COMMITTED:
- PROPOSAL_ID: []
  TARGET_FIELD: []
  FINAL_ACTION: COMMITTED
  NOTES: []

SUPPRESSED:
- PROPOSAL_ID: []
  TARGET_FIELD: []
  FINAL_ACTION: SUPPRESSED
  NOTES: []

DOWNGRADED:
- PROPOSAL_ID: []
  TARGET_FIELD: []
  FINAL_ACTION: DOWNGRADED
  NOTES: []

INVARIANTS_TRIGGERED:
- [NONE]

=== SECTION_BREAK ===

=== SECTION: TEMPORARY_STATE_FLAGS ===

[[LLM_INSTRUCTION]]: For tracking temporary states or summary flags that exist only for the duration of this processing cycle.

CURRENT_THREAT_LEVEL: [LOW | MODERATE | HIGH | CRITICAL]
ACTIVE_COTS:
- [List of all COTs triggered by this input]
CONFLICT_DETECTED: [TRUE | FALSE]
FLOW_STATE_ACTIVE: [TRUE | FALSE]
PERFORMANCE_MODIFIER_TOTAL: [e.g., -20_PERCENT, +15_PERCENT, NONE]
ENVIRONMENTAL_STRESS_TOTAL: [e.g., 45_PERCENT, NONE]
DPF_RECALC_QUEUED: [TRUE | FALSE]

=== SECTION_BREAK ===

=== SECTION: INTERMEDIATE_CALCULATIONS ===

[[LLM_INSTRUCTION]]: Workspace for complex math or logic that doesn't need to be stored permanently.

SALIENCE_CALCULATION:
EMOTIONAL_INTENSITY_SCORE: [Value]
NOVELTY_SCORE: [Value]
SOCIAL_SIGNIFICANCE_SCORE: [Value]
SURVIVAL_RELEVANCE_SCORE: [Value]
FINAL_SALIENCE: [Value]

STRESS_RESPONSE_MODIFIER:
BASE_RESPONSE: [Value]
EMOTIONALITY_MULTIPLIER: [Value]
FINAL_RESPONSE: [Value]

DECISION_WEIGHTING:
IMPULSE_A_WEIGHTED_SCORE: [Value]
IMPULSE_B_WEIGHTED_SCORE: [Value]
IMPULSE_C_WEIGHTED_SCORE: [Value]

=== SECTION_BREAK ===

=== SECTION: SYNTHESIS_WORKSPACE ===

[[LLM_INSTRUCTION]]: Used by DECISION_SYNTHESIS to formalize Guided Synthesis and Unjustified Leap decisions.

NOVEL_CONNECTION_PROPOSAL: [Brief description of the new idea]
SOURCE_PRINCIPLE_INVOKED: [Which COT or concept guided it]
COHERENCE_CHECK: [Why consistent with the system]
CONFLICT_RESOLUTION: [How it resolves with other impulses]
FINAL_SYNTHESIS_DECISION: [EMBRACE | MODIFY | REJECT]

=== SECTION_BREAK ===

=== SECTION: CURRENT_DPF ===

[[LLM_INSTRUCTION]]: Holds the synthesized Dominant Predictive Frame for the current cycle. Generated at cycle start by a DPF synthesis process.

DPF_CORE_STATE:
CORE_ASSUMPTION:
VALUE:
SOURCE:
EMOTIONAL_VALENCE:
VALUE:
SOURCE:
SOURCE_CAUSALITY:
VALUE:
SOURCE:
SOCIAL_STANCE:
VALUE:
SOURCE:

DPF_METRICS:
CERTAINTY_LEVEL:
VALUE:
PACE:
VALUE:
SOURCE:

PREDICTION_REGISTRY:
ACTIVE_PREDICTIONS:
PREDICTION_ID:
TARGET:
HYPOTHESIS:
PARENT_DPF:
STATE:
CERTAINTY:

=== SECTION_BREAK ===

=== SECTION: SELECTED_ACTION ===

[[LLM_INSTRUCTION]]: Written only by DECISION_SYNTHESIS. Exactly one action record per cycle.

ACTION_ID: [Optional, else NONE]
ACTION_SOURCE_IMPULSE: [Winning impulse type]
ACTION_TYPE: [ATTACK | ESCAPE | HIDE | NEGOTIATE | INVESTIGATE | PLAN | REST | USE_SKILL | SEEK_SUPPORT | OTHER]
TARGET_ID: [Optional ENT_XX, SKL_XX, location token, NONE]
CONFIDENCE: [0-100]
RATIONALE: [1-2 lines]
CONFLICT_FLAG: [TRUE | FALSE]
NARRATIVE_ACTION_DESCRIPTION: [Optional one sentence]

=== SECTION_BREAK ===

=== SECTION: CASCADE_TRACE ===

[[LLM_INSTRUCTION]]: Each triggered COT appends an output packet here for debugging and traceability.

TRACE_ENTRY:
COT_NAME:
KEY_OUTPUTS:
- []
GENERATED_IMPULSES:
- []
PROPOSED_UPDATES_COUNT: [0]
NOTES:
- []

=== SECTION_BREAK ===

[KEY_TERM: Document Complete]