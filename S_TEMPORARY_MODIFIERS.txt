=== SECTION: TEMPORARY_MODIFIERS ===

[KEEP: Purpose & Role]
To provide a centralized, persistent storage layer for all temporary, time-bounded, or context-bounded modifiers that should not directly rewrite baseline states in BODY, SKILLS, RELATIONAL, DOMINANT_PREDICTIVE_FRAME, or other modules. This module enables strict separation of concerns by allowing COTs to express short-lived effects as modifiers, while preserving the integrity of canonical HARD_STATE fields.

[KEEP: Relationship to Other Modules]
Informs: PERFORMANCE_STATE_INTEGRATION, STRESS_CASCADE_RESOLUTION, SPATIAL_EMBODIMENT_PROCESSING, TEMPORAL_FLOW_PROCESSING, COMMUNICATION_PROCESSING, DECISION_SYNTHESIS, STATE_GOVERNANCE_AND_COMMIT.
Is Informed By: [COGNITIVE_SCRATCHPAD][PROPOSED_UPDATES_REGISTRY] modifier proposals, STATE_GOVERNANCE_OVERLAY, narrative duration cues.

=== SECTION_BREAK ===

=== SECTION: CORE_CONCEPT ===

[[LLM_INSTRUCTION]]: Modifiers are overlays that affect interpretation and execution but do not permanently change baseline fields unless explicitly converted by a governance rule.

MODIFIER_PRINCIPLES:
- Baseline state lives in persistent modules (HARD_STATE).
- Transient effects live here (SOFT_MODIFIER).
- Modifiers must be explicitly scoped and must expire or be cleared.
- Modifiers must never masquerade as a hidden HARD_STATE SET.

=== SECTION_BREAK ===

=== SECTION: MODIFIER_TYPES ===

[[LLM_INSTRUCTION]]: Only these modifier types are valid.

MODIFIER_TYPES:
- PERFORMANCE_MODIFIER
- AROUSAL_MODIFIER
- ENVIRONMENTAL_MODIFIER
- RELATIONAL_MODIFIER
- BELIEF_MODIFIER
- GOAL_MODIFIER
- COMMUNICATION_MODIFIER
- COGNITIVE_LOAD_MODIFIER
- ALTERATION_TEMPORARY_MODIFIER

=== SECTION_BREAK ===

=== SECTION: CANONICAL_TARGET_ADDRESSING ===

[[LLM_INSTRUCTION]]: All modifier targets must use canonical bracket addressing per S_CANONICAL_TOKEN_DICTIONARY.

TARGET_FIELD_EXAMPLES:
- [BODY][BIOCHEMICAL_STATE_MARKERS][CORTISOL]
- [BODY][PHYSIOLOGICAL_HEALTH][RESPIRATORY_RATE]
- [SKILLS][SKL_03][EXECUTION]
- [RELATIONAL][ENT_01][AFFECTIVE_VALENCE]
- [DOMINANT_PREDICTIVE_FRAME][DPF_CORE_STATE][EMOTIONAL_VALENCE]

TARGET_ID_CONVENTIONS:
- ENT_XX for entity-scoped modifiers
- SKL_XX for skill-scoped modifiers
- ALT_XX for alteration-scoped modifiers
- PRD_XX for prediction-scoped modifiers
- Blank or NONE if not ID-scoped

=== SECTION_BREAK ===

=== SECTION: MODIFIER_REGISTRY ===

[[LLM_INSTRUCTION]]: Store all active modifiers here. Modifiers are persistent until expired or removed by STATE_GOVERNANCE_AND_COMMIT.

MODIFIER_ENTRY:
MODIFIER_ID: [e.g., MOD_0001]
STATUS: [ACTIVE | EXPIRED | SUPPRESSED]

MODIFIER_TYPE: [One of MODIFIER_TYPES]
SOURCE_COT: [e.g., PERFORMANCE_STATE_INTEGRATION]
MECHANISM_TAG: [e.g., PERFORMANCE_PRESSURE, ENVIRONMENTAL_STRESS, HPA_AXIS, SYMPATHETIC]

TARGET_FIELD: [Canonical bracket path]
TARGET_ID: [Optional, e.g., SKL_03, ENT_01, ALT_02, PRD_01, NONE]

EFFECT_EXPRESSION: [Structured human-readable statement]
MAGNITUDE: [Either a percentage string like -20_PERCENT or a 0-100 qualitative strength]
STACKING_RULE: [REPLACE | STACK | MAX | MIN]

DURATION_TYPE: [IMMEDIATE | SCENE | TIMED | UNTIL_CONDITION | PERSISTENT_UNTIL_REMOVED]
DURATION_VALUE: [If TIMED: minutes/hours/days; if SCENE: THIS_SCENE; if UNTIL_CONDITION: brief label; else NONE]
EXPIRY_CONDITION: [If UNTIL_CONDITION: explicit cue; else NONE]

CREATED_TIMESTAMP: [Narrative anchor if available, else UNKNOWN]
LAST_REFRESHED: [Narrative anchor if refreshed, else NONE]
JUSTIFICATION: [1-2 lines]

=== SECTION_BREAK ===

=== SECTION: MODIFIER_IDENTITY_AND_REPLACEMENT_KEYS ===

[[LLM_INSTRUCTION]]: Enforce deterministic replacement and conflict handling.

DERIVED_IDENTITY_KEY:
- IDENTITY_KEY = MODIFIER_TYPE + MECHANISM_TAG + TARGET_FIELD + TARGET_ID

REPLACE_RULE:
- If STACKING_RULE is REPLACE:
  - Only one ACTIVE modifier per IDENTITY_KEY may exist.
  - A new Add_Modifier with the same IDENTITY_KEY must replace the existing modifier:
    - Update MAGNITUDE, EFFECT_EXPRESSION, JUSTIFICATION
    - Set LAST_REFRESHED to current narrative anchor

DEFAULT_STACKING_RULE:
- If STACKING_RULE is missing:
  - Use REPLACE when (MODIFIER_TYPE + MECHANISM_TAG + TARGET_FIELD) match an existing ACTIVE modifier.
  - Otherwise use STACK.

=== SECTION_BREAK ===

=== SECTION: CAPS_AND_CONFLICT_RULES ===

[[LLM_INSTRUCTION]]: Prevent runaway stacking.

PER_TARGET_CAP:
- No more than 5 ACTIVE modifiers may share the same TARGET_FIELD.
- If a 6th would be added:
  - Suppress the weakest (lowest STRENGTH from its originating proposal, or if unknown, lowest MAGNITUDE severity)
  - Mark STATUS as SUPPRESSED
  - Record suppression reason in JUSTIFICATION

PER_MECHANISM_CAP:
- For MECHANISM_TAG HPA_AXIS:
  - Max 2 ACTIVE modifiers system-wide at a time
- For MECHANISM_TAG SYMPATHETIC:
  - Max 2 ACTIVE modifiers system-wide at a time
- Prefer strongest; suppress weaker.

NO_HARD_STATE_MASQUERADE:
- A modifier must not directly claim to SET a HARD_STATE.
- Allowed language: "WEIGHTING", "RISK", "EXECUTION_EFFECTIVE", "IMPULSE_BIAS", "PERCEPTION_SHIFT".
- Disallowed language: "SET [BODY] CORTISOL = BASELINE" inside a modifier.

=== SECTION_BREAK ===

=== SECTION: MODIFIER_DECAY_AND_EXPIRY ===

[[LLM_INSTRUCTION]]: Expire modifiers deterministically.

EXPIRY_RULES:
IMMEDIATE:
- Expire at end of current processing cycle after commit and verification unless refreshed.

SCENE:
- Expire when narrative indicates a clear scene transition.

TIMED:
- Expire when inferred time passage exceeds DURATION_VALUE.

UNTIL_CONDITION:
- Expire only when EXPIRY_CONDITION is explicitly satisfied by narrative input or committed state.

PERSISTENT_UNTIL_REMOVED:
- Does not expire automatically. Must be removed by explicit Remove_Modifier proposal.

=== SECTION_BREAK ===

=== SECTION: GOVERNANCE_COMMIT_INTERFACE ===

[[LLM_INSTRUCTION]]: This defines what STATE_GOVERNANCE_AND_COMMIT is allowed to do to this module.

ALLOWED_OPERATIONS:
- ADD_MODIFIER: Create or replace an entry
- REMOVE_MODIFIER: Expire an entry
- CAP: Enforce caps by suppressing or expiring weakest
- VETO: Suppress a requested modifier change

REQUIRED_FIELDS_FOR_ADD_MODIFIER_PROPOSED_VALUE:
- MODIFIER_TYPE
- MAGNITUDE
- DURATION_TYPE
- EFFECT_EXPRESSION
- MECHANISM_TAG
- TARGET_FIELD
Optional but recommended:
- STACKING_RULE
- TARGET_ID
- DURATION_VALUE
- EXPIRY_CONDITION
- JUSTIFICATION

REMOVE_MODIFIER_MATCH_KEYS:
- Preferred: MODIFIER_ID
- Alternate match key:
  - MODIFIER_TYPE + MECHANISM_TAG + TARGET_FIELD + TARGET_ID

=== SECTION_BREAK ===

=== SECTION: EXAMPLES ===

[[LLM_INSTRUCTION]]: Examples are structural only.

EXAMPLE_PERFORMANCE_PRESSURE:
MODIFIER_ID: MOD_0007
STATUS: ACTIVE
MODIFIER_TYPE: PERFORMANCE_MODIFIER
SOURCE_COT: PERFORMANCE_STATE_INTEGRATION
MECHANISM_TAG: PERFORMANCE_PRESSURE
TARGET_FIELD: [SKILLS][SKL_03][EXECUTION]
TARGET_ID: SKL_03
EFFECT_EXPRESSION: COMPLEX_EXECUTION_DEGRADED_UNDER_EVALUATION
MAGNITUDE: -20_PERCENT
STACKING_RULE: REPLACE
DURATION_TYPE: SCENE
DURATION_VALUE: THIS_SCENE
EXPIRY_CONDITION: SCENE_TRANSITION
CREATED_TIMESTAMP: CURRENT_SCENE
LAST_REFRESHED: CURRENT_SCENE
JUSTIFICATION: PUBLIC_EVALUATION_CUES_PRESENT_CHOKING_RISK

EXAMPLE_ENVIRONMENTAL_NOISE:
MODIFIER_ID: MOD_0012
STATUS: ACTIVE
MODIFIER_TYPE: ENVIRONMENTAL_MODIFIER
SOURCE_COT: SPATIAL_EMBODIMENT_PROCESSING
MECHANISM_TAG: ENVIRONMENTAL_STRESS
TARGET_FIELD: [SKILLS][SKL_02][EXECUTION]
TARGET_ID: SKL_02
EFFECT_EXPRESSION: NOISE_REDUCES_COGNITIVE_BANDWIDTH
MAGNITUDE: -10_PERCENT
STACKING_RULE: STACK
DURATION_TYPE: UNTIL_CONDITION
DURATION_VALUE: WHILE_IN_LOUD_AREA
EXPIRY_CONDITION: LEFT_ENVIRONMENT
CREATED_TIMESTAMP: CURRENT_LOCATION
LAST_REFRESHED: CURRENT_LOCATION
JUSTIFICATION: LOUD_ENVIRONMENT_CUES_PRESENT

=== SECTION_BREAK ===

[KEY_TERM: Document Complete]